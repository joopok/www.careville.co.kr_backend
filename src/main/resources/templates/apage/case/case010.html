<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/apage/default_layout}">
<head>
<title>시공 사례</title>
<!-- All styles now in careville-admin.css -->
<link rel="stylesheet" th:href="@{/plugins/light-gallery/css/lightgallery.css}" />
<script th:src="@{/plugins/light-gallery/js/lightgallery-all.js}"></script>
<script th:src="@{/apage/js/case010.js}"></script>
</head>
<body>
<div layout:fragment="content">

	<form id="searchMap" method="POST">
		<th:block th:each="entry : ${searchMap}">
			<input type="hidden" th:name="${entry.key}" th:value="${entry.value != null ? entry.value : ''}" th:if="${entry.key != 'caseSeq'}">
		</th:block>
	</form>

	<!-- Page Header -->
	<div class="cv-page-header">
		<div class="cv-page-header-left">
			<h1 class="cv-page-title">시공 사례 <span class="count" th:text="${#lists.size(list) > 0 ? '(' + #lists.size(list) + ')' : ''}"></span></h1>
			<p class="cv-page-desc">완료된 프로젝트 포트폴리오</p>
		</div>
		<div class="cv-page-header-right">
			<div class="cv-btn-group" style="margin-right:8px;">
				<button type="button" class="cv-btn cv-btn-ghost cv-btn-sm" id="btnGridView" title="그리드 보기">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<rect x="3" y="3" width="7" height="7"></rect>
						<rect x="14" y="3" width="7" height="7"></rect>
						<rect x="14" y="14" width="7" height="7"></rect>
						<rect x="3" y="14" width="7" height="7"></rect>
					</svg>
				</button>
				<button type="button" class="cv-btn cv-btn-ghost cv-btn-sm" id="btnTableView" title="테이블 보기">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<line x1="3" y1="6" x2="21" y2="6"></line>
						<line x1="3" y1="12" x2="21" y2="12"></line>
						<line x1="3" y1="18" x2="21" y2="18"></line>
					</svg>
				</button>
			</div>
			<button type="button" class="cv-btn cv-btn-primary" id="btnWrite">
				<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<line x1="12" y1="5" x2="12" y2="19"></line>
					<line x1="5" y1="12" x2="19" y2="12"></line>
				</svg>
				사례 등록
			</button>
		</div>
	</div>

	<!-- Search Box -->
	<form id="searchFrom">
		<input type="hidden" name="currPage" value="1">
		<div class="cv-search-box">
			<div class="cv-search-row">
				<div class="cv-search-field wide">
					<input type="text" name="caseSj" class="cv-search-input" placeholder="제목...">
				</div>
				<div class="cv-search-field">
					<input type="text" name="hashtag" class="cv-search-input" placeholder="해시태그...">
				</div>
				<div class="cv-search-field">
					<select id="serviceCd" name="serviceCd" class="cv-search-select">
						<option value="">전체 서비스</option>
						<option th:each="code : ${svcCdList}" th:value="${code.serviceCd}" th:text="${code.serviceNm}"></option>
					</select>
				</div>
				<div class="cv-search-actions">
					<button type="button" class="cv-btn cv-btn-primary btnSearch">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<circle cx="11" cy="11" r="8"></circle>
							<path d="m21 21-4.35-4.35"></path>
						</svg>
						검색
					</button>
				</div>
			</div>
		</div>
	</form>

	<!-- Quick Filter: Service Chips -->
	<div class="cv-card" style="margin-top:12px;">
		<div class="cv-card-body">
			<div class="cv-case-filter" style="display:flex;flex-wrap:wrap;gap:8px;align-items:center;">
				<a href="javascript:void(0)" class="cv-tag svc-chip" data-value="">전체</a>
				<a href="javascript:void(0)" class="cv-tag svc-chip" th:each="code : ${svcCdList}"
				   th:data-value="${code.serviceCd}" th:text="${code.serviceNm}"></a>
			</div>
		</div>
	</div>

	<!-- Case List Table -->
	<div class="cv-card" th:if="${#lists.size(list) > 0}" id="caseListTableBlock">
		<div class="cv-table-wrap">
			<table class="cv-table cv-case-table" id="caseTable">
				<thead>
					<tr>
						<th style="width: 200px;">번호</th>
						<th style="width: 80px;">사진</th>
						<th>제목</th>
						<th style="width: 140px;">서비스</th>
						<th style="width: 200px;">해시태그</th>
						<th style="width: 120px;">등록일</th>
						<th style="width: 80px;">관리</th>
					</tr>
				</thead>
				<tbody>
					<tr class="cv-case-row templateView" th:each="item, iterStat : ${list}" th:data-key="${item.caseSeq}">
						<td class="cv-case-num-cell">
							<span class="cv-case-num" th:text="${rowNum - iterStat.index}">1</span>
						</td>
						<td class="cv-case-thumb-cell">
                            <div class="cv-case-thumb">
                                <img th:src="@{|/fileThumbView.do?viewFileSeq=${item.viewFileSeq}&w=120|}" th:alt="${item.caseSj}" loading="lazy" th:if="${item.viewFileSeq != null and item.viewFileSeq != ''}">
                                <div class="cv-case-thumb-empty" th:if="${item.viewFileSeq == null or item.viewFileSeq == ''}">
									<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
										<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
										<circle cx="8.5" cy="8.5" r="1.5"></circle>
										<polyline points="21 15 16 10 5 21"></polyline>
									</svg>
								</div>
							</div>
						</td>
						<td class="cv-case-title-cell">
							<span class="cv-case-title" th:text="${item.caseSj}">사례 제목</span>
						</td>
						<td>
							<span class="cv-badge cv-badge-info" th:text="${item.serviceNm ?: '-'}">서비스명</span>
						</td>
						<td class="cv-case-tags-cell">
							<div class="cv-case-tags" th:with="tags=${item.hashtag != null and item.hashtag != '' ? #strings.arraySplit(item.hashtag, ',') : null}, tagCount=${tags != null ? #arrays.length(tags) : 0}">
								<th:block th:if="${tags != null}">
									<span class="cv-tag" th:each="tag, iterStat : ${tags}" th:if="${iterStat.index < 3}" th:text="${tag}"></span>
									<span class="cv-tag cv-tag-more" th:if="${tagCount > 3}" th:text="|+${tagCount - 3}|"></span>
								</th:block>
								<span class="cv-tag cv-tag-empty" th:if="${tags == null}">-</span>
							</div>
						</td>
						<td>
							<span class="cv-text-muted" th:text="${item.rgsDt}">2024-01-01</span>
						</td>
						<td>
							<button type="button" class="cv-btn cv-btn-sm cv-btn-outline btnView" th:data-key="${item.caseSeq}">
								<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
									<circle cx="12" cy="12" r="3"></circle>
								</svg>
							</button>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<!-- Case Grid View -->
	<div class="cv-card" th:if="${#lists.size(list) > 0}" id="caseListGridBlock" style="display:none;">
		<div class="cv-case-grid">
			<div class="cv-case-card" th:each="item, iterStat : ${list}" th:attr="data-key=${item.caseSeq}">
                <img class="cv-case-img" th:src="@{|/fileThumbView.do?viewFileSeq=${item.viewFileSeq}&w=600|}" th:alt="${item.caseSj}" loading="lazy" th:if="${item.viewFileSeq != null and item.viewFileSeq != ''}">
				<div class="cv-case-img-placeholder" th:if="${item.viewFileSeq == null or item.viewFileSeq == ''}">
					<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
						<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
						<circle cx="8.5" cy="8.5" r="1.5"></circle>
						<polyline points="21 15 16 10 5 21"></polyline>
					</svg>
				</div>
				<div class="cv-case-content">
					<div class="cv-case-title" th:text="${item.caseSj}">사례 제목</div>
					<div class="cv-case-service">
						<span class="cv-badge cv-badge-info" th:text="${item.serviceNm ?: '-'}">서비스명</span>
					</div>
					<div class="cv-case-tags" th:with="tags=${item.hashtag != null and item.hashtag != '' ? #strings.arraySplit(item.hashtag, ',') : null}, tagCount=${tags != null ? #arrays.length(tags) : 0}">
						<th:block th:if="${tags != null}">
							<span class="cv-case-tag" th:each="tag, iterStat2 : ${tags}" th:if="${iterStat2.index < 3}" th:text="${tag}"></span>
							<span class="cv-case-tag empty" th:if="${tagCount > 3}"
							      th:attr="title=${item.hashtag}" th:text="|+${tagCount - 3}|"></span>
						</th:block>
						<span class="cv-case-tag empty" th:if="${tags == null}">-</span>
					</div>
					<div class="cv-text-muted" th:text="${item.rgsDt}" style="margin-top:6px;"></div>
					<div class="cv-case-action" style="margin-top:8px;">
						<button type="button" class="cv-btn cv-btn-sm cv-btn-outline btnView" th:data-key="${item.caseSeq}">보기</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Empty State -->
	<div class="cv-empty-state" th:if="${#lists.isEmpty(list)}">
		<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="margin-bottom: 16px; opacity: 0.5;">
			<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
			<circle cx="8.5" cy="8.5" r="1.5"></circle>
			<polyline points="21 15 16 10 5 21"></polyline>
		</svg>
		<p style="font-size: 16px; font-weight: 500; margin-bottom: 4px;">시공 사례가 없습니다</p>
		<p style="font-size: 14px;">첫 번째 시공 사례를 등록해 주세요</p>
	</div>

	<!-- Pagination -->
	<div id="pagination" class="cv-pagination-wrap" th:if="${#lists.size(list) > 0}">
		<div class="cv-pagination">
			<a href="javascript:void(0);" class="cv-pagination-item" th:classappend="${pagination.prev == 0} ? 'disabled'" th:data-key="${pagination.prev}">&laquo;</a>
			<th:block th:each="num : ${pagination.order}">
				<span class="cv-pagination-item active" th:if="${pagination.currPage == num}" th:text="${num}">1</span>
				<a href="javascript:void(0);" class="cv-pagination-item" th:unless="${pagination.currPage == num}" th:data-key="${num}" th:text="${num}">1</a>
			</th:block>
			<a href="javascript:void(0);" class="cv-pagination-item" th:classappend="${pagination.next == 0} ? 'disabled'" th:data-key="${pagination.next}">&raquo;</a>
		</div>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="defaultModal" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title" id="defaultModalLabel">시공 사례 상세</h4>
				</div>
				<div class="modal-body" id="viewDiv">
				</div>
				<div class="modal-footer">
					<button type="button" class="cv-btn cv-btn-primary btnModalUpdate">수정</button>
					<button type="button" class="cv-btn cv-btn-secondary" data-dismiss="modal">닫기</button>
				</div>
			</div>
		</div>
	</div>

</div>
</body>
</html>
